{% extends "admin/base.html" %}
{% block content %}
<div class="container">
    <h2 class="my-4">Управление пользователями</h2>
    
    <!-- Форма добавления пользователя -->
    <form method="POST" class="mb-4 p-4 bg-light border rounded">
        <div class="form-row">
            <div class="form-group col-md-6">
                <input type="text" class="form-control" name="full_name" placeholder="ФИО" required>
            </div>
            <div class="form-group col-md-6">
                <input type="text" class="form-control" name="phone" placeholder="Телефон" required>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-6">
                <input type="text" class="form-control" name="organization" placeholder="Организация" required>
            </div>
            <div class="form-group col-md-6">
                <input type="text" class="form-control" name="login" placeholder="Логин" required>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-6">
                <input type="password" class="form-control" name="password" placeholder="Пароль" required>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Добавить</button>
    </form>

    <!-- Таблица пользователей -->
    <table class="table table-bordered table-striped">
        <thead class="thead-dark">
            <tr>
                <th>ФИО</th>
                <th>Телефон</th>
                <th>Организация</th>
                <th>Логин</th>
                <th>Статус</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.full_name }}</td>
                <td>{{ user.phone }}</td>
                <td>{{ user.organization }}</td>
                <td>{{ user.login }}</td>
                <td>
                    {% if user.is_approved %}
                        <span class="text-success">Подтвержден</span>
                    {% elif user.is_reject %}
                        <span class="text-danger">Отклонен</span>
                    {% else %}
                        <span class="text-warning">Ожидает подтверждения</span>
                    {% endif %}
                </td>
                <td>
                    {% if not user.is_approved and not user.is_reject %}
                        <form action="{{ url_for('approve_user', user_id=user.id) }}" method="POST" style="display: inline;">
                            <button type="submit" class="btn btn-success btn-sm">Одобрить</button>
                        </form>
                        <form action="{{ url_for('reject_user', user_id=user.id) }}" method="POST" style="display: inline;">
                            <button type="submit" class="btn btn-warning btn-sm">Отклонить</button>
                        </form>
                    {% endif %}
                    <form action="{{ url_for('delete_user', user_id=user.id) }}" method="POST" style="display: inline;">
                        <button type="submit" class="btn btn-danger btn-sm">Удалить</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}